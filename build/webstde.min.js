"use strict";var webSTDE=(()=>{var T=Object.defineProperty;var D=Object.getOwnPropertyDescriptor;var O=Object.getOwnPropertyNames;var P=Object.prototype.hasOwnProperty;var N=(s,t)=>{for(var n in t)T(s,n,{get:t[n],enumerable:!0})},J=(s,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of O(t))!P.call(s,e)&&e!==n&&T(s,e,{get:()=>t[e],enumerable:!(i=D(t,e))||i.enumerable});return s};var _=s=>J(T({},"__esModule",{value:!0}),s);var G={};N(G,{GuiState:()=>M,guiState:()=>b,init:()=>A,machine:()=>d,mousePos:()=>v});function g(s,t){switch(t.clearRect(0,0,s.width,s.height),t.font="28px Arial",t.textAlign="left",t.fillText("output vector = [y1, y2]",10,35),d.draw(t),b){case"INSERT_STATE":t.strokeStyle="gray",x(t,!0,d.snap(v),220,100);break}}function x(s,t,n,i,e,l=""){t?(s.strokeStyle="blue",s.fillStyle="blue",s.lineWidth=4):(s.strokeStyle="black",s.fillStyle="black",s.lineWidth=2),s.beginPath(),s.ellipse(n.x,n.y,i/2,e/2,0,0,2*Math.PI),s.stroke(),s.moveTo(n.x-i/2,n.y),s.lineTo(n.x+i/2,n.y),s.stroke(),s.font="24px Arial",s.textAlign="center",s.fillText(l,n.x,n.y-e/6)}var L=class{constructor(){this.id="";this.signals=[];this.states=[];this.transitions=[]}addSignal(t){this.signals.push(t)}addState(t){this.states.push(t),this.recalculateStateIndices()}draw(t){for(let n of this.states)n.draw(t)}select(t){for(let n of this.states)n.select(t)}getSignals(){return this.signals}getStates(){return this.states}getSelectedStates(){let t=[];for(let n of this.states)n.isSelected()&&t.push(n);return t}deleteSelection(){let t=[];for(let n of this.states)n.isSelected()==!1&&t.push(n);this.states=t,this.recalculateStateIndices()}snap(t){let i=t;for(let e of this.states)Math.abs(e.getPos().x-t.x)<=25&&(i.x=e.getPos().x),Math.abs(e.getPos().y-t.y)<=25&&(i.y=e.getPos().y);return i}recalculateStateIndices(){let t=this.states.length;for(let n=0;n<t;n++)this.states[n].setIdx(n)}toJSON(){return{id:this.id,signals:this.signals.map(t=>t.toJSON()),states:this.states.map(t=>t.toJSON())}}},C=class{constructor(t,n,i,e,l=""){this.id="";this.type=k.Bit;this.bits=1;this.direction=H.Input;this.desc="";this.id=t,this.type=n,this.bits=i,this.direction=e,this.desc=l}setId(t){this.id=t}getId(){return this.id}toJSON(){return{id:this.id,type:this.type,bits:this.bits,io:this.direction,desc:this.desc}}},k=(e=>(e.Bit="bit",e.BitN="bit_n",e.Signed="signed",e.Unsigned="unsigned",e))(k||{}),H=(i=>(i.Input="input",i.Output="output",i.InputOutput="inputOutput",i))(H||{}),I=class{constructor(t,n,i="",e=""){this.selected=!1;this.pos={x:0,y:0};this.width=220;this.height=110;this.id="";this.idx=0;this.code="";this.desc="";this.mooreOutput={};this.pos.x=t.x,this.pos.y=t.y,this.id=n,this.code=i,this.desc=e}setId(t){this.id=t}getId(){return this.id}getIdx(){return this.idx}setIdx(t){this.idx=t}setCode(t){this.code=t}getCode(){return this.code}setDesc(t){this.desc=t}getDesc(){return this.desc}getPos(){return this.pos}isSelected(){return this.selected}draw(t){x(t,this.selected,this.pos,this.width,this.height,this.id)}select(t){this.selected=t.x>=this.pos.x-this.width/2&&t.x<=this.pos.x+this.width/2&&t.y>=this.pos.y-this.height/2&&t.y<=this.pos.y+this.height/2}toJSON(){return{id:this.id,x:this.pos.x,y:this.pos.y,code:this.code,desc:this.desc,q:this.mooreOutput}}};var M=(n=>(n.Select="SELECT",n.InsertMachineState="INSERT_STATE",n))(M||{}),b="SELECT",v={x:0,y:0},d=new L,c=null,S=null;function A(){let s=document.getElementById("help");s.onclick=function(){let m="help.html";window.open(m,"_blank").focus()};let t=document.getElementById("save");t.onclick=function(){console.log(JSON.stringify(d.toJSON(),null,2))};let n=document.getElementById("select");n.checked=!0,n.onclick=function(){b="SELECT"};let i=document.getElementById("insertStartState");i.onclick=function(){console.log("clicked insert start state!")};let e=document.getElementById("insertState");e.onclick=function(){b="INSERT_STATE"};let l=document.getElementById("insertTransition");l.onclick=function(){console.log("clicked insert transition!")};let r=document.getElementById("delete");r.onclick=function(){d.deleteSelection(),g(c,S)};let a=!1,p=document.getElementById("numberConverter"),o=document.getElementById("selection"),u=document.getElementById("signals");u.innerHTML="",u.appendChild(B(d.getSignals())),document.getElementById("addSignal").addEventListener("onclick",m=>{let h=new C("","bit",1,"input","");d.addSignal(h),u.innerHTML="",u.appendChild(B(d.getSignals()))});let y=document.getElementById("numberConverterCollapse");y.onclick=function(){a=!a,y.innerHTML=a?'<i class="fa-solid fa-square-minus"></i>':'<i class="fa-solid fa-square-plus"></i>',p.style.display=a?"block":"none"},c=document.getElementById("canvas"),S=c.getContext("2d"),c.addEventListener("mousemove",m=>{let h=c.getBoundingClientRect(),E=window.devicePixelRatio||1;v.x=Math.round((m.clientX-h.left)*E),v.y=Math.round((m.clientY-h.top)*E),g(c,S)}),c.addEventListener("mouseup",m=>{switch(b){case"SELECT":d.select(v);let h=d.getSelectedStates();if(h.length==0)o.innerHTML="(empty)";else{o.innerHTML="";let w=R(h);o.appendChild(w)}break;case"INSERT_STATE":b="SELECT",n.checked=!0;let E=new I(v,"");d.addState(E);break}g(c,S)}),g(c,S)}function B(s){let t=document.createElement("table");t.classList.add("table","table-bordered","border-dark","shadow");let n=document.createElement("thead");t.appendChild(n);let i=document.createElement("tr");n.appendChild(i),i.classList.add("m-0","p-0");let e=document.createElement("th");i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="ID",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="TYPE",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="BITS",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="I/O",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="";let l=document.createElement("tbody");t.appendChild(l);for(let r of s){i=document.createElement("tr"),l.appendChild(i),e=document.createElement("th"),i.appendChild(e),e.classList.add("m-0","p-0"),e.scope="row";let a=document.createElement("input");e.appendChild(a),a.type="text",a.classList.add("form-control","border-white"),a.value=r.getId(),a.addEventListener("keyup",p=>{let o=p.target.value;r.setId(o),g(c,S)})}return t}function R(s){let t=document.createElement("table");t.classList.add("table","table-bordered","border-dark","shadow");let n=document.createElement("thead");t.appendChild(n);let i=document.createElement("tr");n.appendChild(i),i.classList.add("m-0","p-0");let e=document.createElement("th");i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="STATE ID";let l=document.createElement("tbody");t.appendChild(l);for(let r of s){i=document.createElement("tr"),l.appendChild(i),e=document.createElement("th"),i.appendChild(e),e.classList.add("m-0","p-0"),e.scope="row";let a=document.createElement("input");e.appendChild(a),a.type="text",a.classList.add("form-control","border-white"),a.value=r.getId(),a.addEventListener("keyup",p=>{let o=p.target.value;r.setId(o),g(c,S)});for(let p=0;p<2;p++){i=document.createElement("tr"),l.appendChild(i);let o=document.createElement("td");i.appendChild(o),o.colSpan=1,o.classList.add("m-0","p-0");let u=document.createElement("div");u.classList.add("btn-group"),o.appendChild(u),u.style.width="calc(100% - 15px)";let f=document.createElement("div");u.appendChild(f),f.classList.add("col","mt-1","ms-1","p-0"),f.style.maxWidth="32px",p==0?f.innerHTML='&nbsp;&nbsp;<i class="fa-solid fa-code"></i>':f.innerHTML='&nbsp;&nbsp;<i class="fa-solid fa-quote-left"></i>';let y=document.createElement("div");u.append(y),y.classList.add("col","m-0","p-0"),a=document.createElement("input"),y.appendChild(a),a.type="text",a.classList.add("form-control","border-white","m-1","p-0"),a.value=p==0?r.getCode():r.getDesc(),a.addEventListener("keyup",m=>{let h=m.target.value;p==0?r.setCode(h):r.setDesc(h),g(c,S)})}}return t}return _(G);})();
