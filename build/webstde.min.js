"use strict";var webSTDE=(()=>{var N=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var U=Object.getOwnPropertyNames;var _=Object.prototype.hasOwnProperty;var R=(s,t)=>{for(var n in t)N(s,n,{get:t[n],enumerable:!0})},q=(s,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of U(t))!_.call(s,e)&&e!==n&&N(s,e,{get:()=>t[e],enumerable:!(i=G(t,e))||i.enumerable});return s};var W=s=>q(N({},"__esModule",{value:!0}),s);var X={};R(X,{GuiState:()=>P,guiState:()=>T,init:()=>Y,machine:()=>u,mousePos:()=>I});function f(s,t){switch(t.clearRect(0,0,s.width,s.height),t.font="28px Arial",t.textAlign="left",t.fillText("output vector = [y1, y2]",10,35),u.draw(t),T){case"INSERT_STATE":t.strokeStyle="gray",O(t,!0,u.snap(I),220,100);break}}function O(s,t,n,i,e,g=""){t?(s.strokeStyle="blue",s.fillStyle="blue",s.lineWidth=4):(s.strokeStyle="black",s.fillStyle="black",s.lineWidth=2),s.beginPath(),s.ellipse(n.x,n.y,i/2,e/2,0,0,2*Math.PI),s.stroke(),s.moveTo(n.x-i/2,n.y),s.lineTo(n.x+i/2,n.y),s.stroke(),s.font="24px Arial",s.textAlign="center",s.fillText(g,n.x,n.y-e/6)}var M=class{constructor(){this.id="";this.signals=[];this.states=[];this.transitions=[]}addSignal(t){this.signals.push(t)}addState(t){this.states.push(t),this.recalculateStateIndices()}draw(t){for(let n of this.states)n.draw(t)}select(t){for(let n of this.states)n.select(t)}getSignals(){return this.signals}getStates(){return this.states}getSelectedStates(){let t=[];for(let n of this.states)n.isSelected()&&t.push(n);return t}deleteSelection(){let t=[];for(let n of this.states)n.isSelected()==!1&&t.push(n);this.states=t,this.recalculateStateIndices()}snap(t){let i=t;for(let e of this.states)Math.abs(e.getPos().x-t.x)<=25&&(i.x=e.getPos().x),Math.abs(e.getPos().y-t.y)<=25&&(i.y=e.getPos().y);return i}removeSignal(t){let n=this.signals.indexOf(t);n!==-1&&this.signals.splice(n,1)}moveUpSignal(t){let n=this.signals.indexOf(t);if(n>0){let i=this.signals[n];this.signals[n]=this.signals[n-1],this.signals[n-1]=i}}moveDownSignal(t){let n=this.signals.indexOf(t);if(n>=0&&n+1<this.signals.length){let i=this.signals[n];this.signals[n]=this.signals[n+1],this.signals[n+1]=i}}recalculateStateIndices(){let t=this.states.length;for(let n=0;n<t;n++)this.states[n].setIdx(n)}toJSON(){return{id:this.id,signals:this.signals.map(t=>t.toJSON()),states:this.states.map(t=>t.toJSON())}}},k=class{constructor(t,n,i,e,g=""){this.id="";this.type=A.Bit;this.bits=1;this.direction=J.Input;this.desc="";this.id=t,this.type=n,this.bits=i,this.direction=e,this.desc=g}setId(t){this.id=t}setType(t){this.type=t}getType(){return this.type}getId(){return this.id}setBits(t){this.bits=t}getBits(){return this.bits}setDirection(t){this.direction=t}getDirection(){return this.direction}setDesc(t){this.desc=t}getDesc(){return this.desc}toJSON(){return{id:this.id,type:this.type,bits:this.bits,io:this.direction,desc:this.desc}}},A=(e=>(e.Bit="BIT",e.BitN="BIT_N",e.Signed="SIGNED",e.Unsigned="UNSIGNED",e))(A||{}),J=(i=>(i.Input="IN",i.Output="OUT",i.InputOutput="INOUT",i))(J||{}),w=class{constructor(t,n,i="",e=""){this.selected=!1;this.pos={x:0,y:0};this.width=220;this.height=110;this.id="";this.idx=0;this.code="";this.desc="";this.mooreOutput={};this.pos.x=t.x,this.pos.y=t.y,this.id=n,this.code=i,this.desc=e}setId(t){this.id=t}getId(){return this.id}getIdx(){return this.idx}setIdx(t){this.idx=t}setCode(t){this.code=t}getCode(){return this.code}setDesc(t){this.desc=t}getDesc(){return this.desc}getPos(){return this.pos}isSelected(){return this.selected}draw(t){O(t,this.selected,this.pos,this.width,this.height,this.id)}select(t){this.selected=t.x>=this.pos.x-this.width/2&&t.x<=this.pos.x+this.width/2&&t.y>=this.pos.y-this.height/2&&t.y<=this.pos.y+this.height/2}toJSON(){return{id:this.id,x:this.pos.x,y:this.pos.y,code:this.code,desc:this.desc,q:this.mooreOutput}}};var P=(n=>(n.Select="SELECT",n.InsertMachineState="INSERT_STATE",n))(P||{}),T="SELECT",I={x:0,y:0},u=new M,h=null,y=null;function Y(){let s=document.getElementById("help");s.onclick=function(){let E="help.html";window.open(E,"_blank").focus()};let t=document.getElementById("save");t.onclick=function(){console.log(JSON.stringify(u.toJSON(),null,2))};let n=document.getElementById("select");n.checked=!0,n.onclick=function(){T="SELECT"};let i=document.getElementById("insertStartState");i.onclick=function(){console.log("clicked insert start state!")};let e=document.getElementById("insertState");e.onclick=function(){T="INSERT_STATE"};let g=document.getElementById("insertTransition");g.onclick=function(){console.log("clicked insert transition!")};let o=document.getElementById("delete");o.onclick=function(){u.deleteSelection(),f(h,y)};let a=!1,S=document.getElementById("numberConverter"),d=document.getElementById("selection"),r=document.getElementById("signals");r.innerHTML="",r.appendChild(D(u.getSignals()));let l=document.getElementById("addSignal");l.onclick=function(){console.log("add");let E=new k("","BIT",1,"IN","");u.addSignal(E),r.innerHTML="",r.appendChild(D(u.getSignals()))};let m=document.getElementById("numberConverterCollapse");m.onclick=function(){a=!a,m.innerHTML=a?'<i class="fa-solid fa-square-minus"></i>':'<i class="fa-solid fa-square-plus"></i>',S.style.display=a?"block":"none"},h=document.getElementById("canvas"),y=h.getContext("2d"),h.addEventListener("mousemove",E=>{let v=h.getBoundingClientRect(),C=window.devicePixelRatio||1;I.x=Math.round((E.clientX-v.left)*C),I.y=Math.round((E.clientY-v.top)*C),f(h,y)}),h.addEventListener("mouseup",E=>{switch(T){case"SELECT":u.select(I);let v=u.getSelectedStates();if(v.length==0)d.innerHTML="(empty)";else{d.innerHTML="";let L=V(v);d.appendChild(L)}break;case"INSERT_STATE":T="SELECT",n.checked=!0;let C=new w(I,"");u.addState(C);break}f(h,y)}),f(h,y)}function D(s){let t=document.createElement("table");t.classList.add("table","table-bordered","border-dark","shadow"),t.style.tableLayout="fixed";let n=document.createElement("thead");t.appendChild(n);let i=document.createElement("tr");n.appendChild(i),i.classList.add("m-0","p-0");let e=document.createElement("th");i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="ID",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="TYPE",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="BITS",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="I/O",e=document.createElement("th"),i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="";let g=document.createElement("tbody");t.appendChild(g);for(let o of s){i=document.createElement("tr"),g.appendChild(i),e=document.createElement("th"),i.appendChild(e),e.classList.add("m-0","p-0"),e.scope="row";let a=document.createElement("input");e.appendChild(a),a.type="text",a.classList.add("form-control","border-white"),a.value=o.getId(),a.addEventListener("keyup",c=>{let b=c.target.value;o.setId(b),f(h,y)});let S=["BIT","BIT_N","SIGNED","UNSIGNED"],d=document.createElement("td");i.appendChild(d),d.classList.add("m-0","p-1");let r=document.createElement("div");d.appendChild(r),r.classList.add("dropdown");let l=document.createElement("button");r.appendChild(l),l.classList.add("btn","btn-sm","btn-outline-secondary","text-dark","dropdown-toggle","border-white"),l.type="button",l.setAttribute("data-bs-toggle","dropdown"),l.setAttribute("aria-expanded","false"),l.innerHTML=o.getType();let m=document.createElement("ul");r.appendChild(m),m.classList.add("dropdown-menu");for(let c of S){let b=document.createElement("li");m.appendChild(b);let p=document.createElement("a");b.appendChild(p),p.classList.add("dropdown-item"),p.style.cursor="pointer",p.innerHTML=c;let B=l;p.onclick=function(){switch(c){case"BIT":o.setType("BIT");break;case"BIT_N":o.setType("BIT_N");break;case"SIGNED":o.setType("SIGNED");break;case"UNSIGNED":o.setType("UNSIGNED");break}B.innerHTML=c}}d=document.createElement("td"),i.appendChild(d),d.classList.add("m-0","p-0"),a=document.createElement("input"),d.appendChild(a),a.type="text",a.classList.add("form-control","border-white"),a.value=""+o.getBits(),a.addEventListener("keyup",c=>{let b=c.target.value;o.setBits(parseInt(b)),f(h,y)});let E=["IN","OUT","INOUT"];d=document.createElement("td"),i.appendChild(d),d.classList.add("m-0","p-1"),r=document.createElement("div"),d.appendChild(r),r.classList.add("dropdown"),l=document.createElement("button"),r.appendChild(l),l.classList.add("btn","btn-sm","btn-outline-secondary","text-dark","dropdown-toggle","border-white"),l.type="button",l.setAttribute("data-bs-toggle","dropdown"),l.setAttribute("aria-expanded","false"),l.innerHTML=o.getDirection(),m=document.createElement("ul"),r.appendChild(m),m.classList.add("dropdown-menu");for(let c of E){let b=document.createElement("li");m.appendChild(b);let p=document.createElement("a");b.appendChild(p),p.classList.add("dropdown-item"),p.style.cursor="pointer",p.innerHTML=c;let B=l;p.onclick=function(){switch(c){case"IN":o.setDirection("IN");break;case"OUT":o.setDirection("OUT");break;case"INOUT":o.setDirection("INOUT");break}B.innerHTML=c}}d=document.createElement("td"),i.appendChild(d),d.classList.add("m-0","p-1","text-center");let v=['<i class="fa-solid fa-arrow-up"></i>','<i class="fa-solid fa-arrow-down"></i>','<i class="fa-solid fa-trash-can"></i>'],C=["move up","move down","delete"];for(let c=0;c<v.length;c++){let b=v[c];l=document.createElement("button"),d.appendChild(l),l.classList.add("btn","btn-sm","btn-outline-dark","text-dark"),l.setAttribute("data-bs-toggle","tooltip"),l.setAttribute("data-bs-placement","bottom"),l.title=C[c],l.innerHTML=(c>0?"&nbsp;":"")+b,c==0||c==1?l.onclick=function(){c==0?u.moveUpSignal(o):u.moveDownSignal(o);let p=document.getElementById("signals");p.innerHTML="",p.appendChild(D(u.getSignals()))}:l.onclick=function(){u.removeSignal(o);let p=document.getElementById("signals");p.innerHTML="",p.appendChild(D(u.getSignals()))}}i=document.createElement("tr"),g.appendChild(i),d=document.createElement("td"),i.appendChild(d),d.colSpan=5,d.classList.add("m-0","p-0");let L=document.createElement("div");L.classList.add("btn-group"),d.appendChild(L),L.style.width="calc(100% - 15px)";let x=document.createElement("div");L.appendChild(x),x.classList.add("col","mt-1","ms-1","p-0"),x.style.maxWidth="32px",x.innerHTML='&nbsp;&nbsp;<i class="fa-solid fa-quote-left"></i>';let H=document.createElement("div");L.append(H),H.classList.add("col","m-0","p-0"),a=document.createElement("input"),H.appendChild(a),a.type="text",a.classList.add("form-control","border-white","m-1","p-0"),a.value=o.getDesc(),a.addEventListener("keyup",c=>{let b=c.target.value;o.setDesc(b),f(h,y)})}return t}function V(s){let t=document.createElement("table");t.classList.add("table","table-bordered","border-dark","shadow");let n=document.createElement("thead");t.appendChild(n);let i=document.createElement("tr");n.appendChild(i),i.classList.add("m-0","p-0");let e=document.createElement("th");i.appendChild(e),e.classList.add("bg-light","text-dark","my-1","py-1"),e.scope="col",e.innerHTML="STATE ID";let g=document.createElement("tbody");t.appendChild(g);for(let o of s){i=document.createElement("tr"),g.appendChild(i),e=document.createElement("th"),i.appendChild(e),e.classList.add("m-0","p-0"),e.scope="row";let a=document.createElement("input");e.appendChild(a),a.type="text",a.classList.add("form-control","border-white"),a.value=o.getId(),a.addEventListener("keyup",S=>{let d=S.target.value;o.setId(d),f(h,y)});for(let S=0;S<2;S++){i=document.createElement("tr"),g.appendChild(i);let d=document.createElement("td");i.appendChild(d),d.colSpan=1,d.classList.add("m-0","p-0");let r=document.createElement("div");r.classList.add("btn-group"),d.appendChild(r),r.style.width="calc(100% - 15px)";let l=document.createElement("div");r.appendChild(l),l.classList.add("col","mt-1","ms-1","p-0"),l.style.maxWidth="32px",S==0?l.innerHTML='&nbsp;&nbsp;<i class="fa-solid fa-code"></i>':l.innerHTML='&nbsp;&nbsp;<i class="fa-solid fa-quote-left"></i>';let m=document.createElement("div");r.append(m),m.classList.add("col","m-0","p-0"),a=document.createElement("input"),m.appendChild(a),a.type="text",a.classList.add("form-control","border-white","m-1","p-0"),a.value=S==0?o.getCode():o.getDesc(),a.addEventListener("keyup",E=>{let v=E.target.value;S==0?o.setCode(v):o.setDesc(v),f(h,y)})}}return t}return W(X);})();
