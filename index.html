<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Web STDE</title>

    <script src="node_modules/axios/dist/axios.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <link
      rel="stylesheet"
      href="node_modules/bootstrap/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="node_modules/@fortawesome/fontawesome-free/css/all.min.css"
    />

    <!-- TODO: ensure that latest(!!) version is loaded! -->
    <!--<script src="build/mathebuddy-simulator.min.js"></script>-->

    <style>
      body,
      html {
        /*background-color: rgb(240, 240, 240);*/
        background-color: rgb(150, 150, 150);
        height: calc(100% - 35px);
        font-size: 8.5pt;
      }
      body {
        overflow: hidden;
      }
    </style>
  </head>

  <body>
    <div class="container-fluid">
      <div class="row py-0">
        <div class="col mb-1 py-2 bg-white shadow">
          &nbsp;
          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="help"
          >
            <i class="fa-regular fa-circle-question"></i>
          </button>
          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="load example"
          >
            <i class="fa-regular fa-circle-play"></i>
          </button>
          &nbsp;&nbsp;
          <!--<span class="text-dark" style="font-size: 16px"><b>webSTDE</b></span>-->

          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="create new diagram"
          >
            <i class="fa-solid fa-plus"></i>
          </button>
          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="open file"
          >
            <i class="fa-solid fa-upload"></i>
          </button>
          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="save file"
          >
            <i class="fa-solid fa-download"></i>
          </button>
          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="preferences"
          >
            <i class="fa-solid fa-gear"></i>
          </button>

          <!--&nbsp;&nbsp;&nbsp;

          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnradio1"
              autocomplete="off"
              checked
            />
            <label
              class="btn btn-outline-dark"
              for="btnradio1"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="select mode"
              ><i class="fa-regular fa-hand-pointer"></i
            ></label>
            <input
              type="radio"
              class="btn-check"
              name="btnradio"
              id="btnradio2"
            />
            <label
              class="btn btn-outline-dark"
              for="btnradio2"
              autocomplete="off"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="insert mode"
              ><i class="fa-solid fa-pencil"></i
            ></label>
          </div>-->

          &nbsp;&nbsp;&nbsp;

          <div
            class="btn-group"
            role="group"
            aria-label="Basic radio toggle button group"
          >
            <input
              type="radio"
              class="btn-check"
              name="selectInsert"
              id="select"
              autocomplete="off"
              checked
            />
            <label
              class="btn btn-outline-dark"
              for="select"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="select item(s)"
            >
              <i class="fa-regular fa-hand-pointer"></i>
            </label>
            <input
              type="radio"
              class="btn-check"
              name="selectInsert"
              id="insertStartState"
            />
            <label
              class="btn btn-outline-dark"
              for="insertStartState"
              autocomplete="off"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="insert start state"
            >
              <i class="fa-solid fa-circle"></i>
            </label>
            <input
              type="radio"
              class="btn-check"
              name="selectInsert"
              id="insertState"
            />
            <label
              class="btn btn-outline-dark"
              for="insertState"
              autocomplete="off"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="insert state"
            >
              <i class="fa-regular fa-circle"></i>
            </label>
            <input
              type="radio"
              class="btn-check"
              name="selectInsert"
              id="insertTransition"
            />
            <label
              class="btn btn-outline-dark"
              for="insertTransition"
              autocomplete="off"
              data-bs-toggle="tooltip"
              data-bs-placement="bottom"
              title="insert transition"
            >
              <i class="fa-solid fa-arrow-right"></i>
            </label>
          </div>

          &nbsp;&nbsp;&nbsp;
          <button
            type="button"
            class="btn btn-outline-dark"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="delete selection"
          >
            <i class="fa-solid fa-trash-can"></i>
          </button>

          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

          <!--<i class="fa-solid fa-earth-europe"></i>-->
          &nbsp;&nbsp;&nbsp;

          <div
            class="btn-group"
            data-bs-toggle="tooltip"
            data-bs-placement="bottom"
            title="number converter"
          >
            <div
              class="btn-group"
              role="group"
              aria-label="Basic radio toggle button group"
            >
              <input
                type="radio"
                class="btn-check"
                name="signedUnsignedRadio"
                id="radioUnsigned"
                autocomplete="off"
                checked
              />
              <label
                class="btn btn-outline-secondary"
                for="radioUnsigned"
                data-bs-toggle="tooltip"
                data-bs-placement="bottom"
                title="unsigned"
              >
                <i class="fa-solid fa-plus"></i>
              </label>
              <input
                type="radio"
                class="btn-check"
                name="signedUnsignedRadio"
                id="radioSigned"
              />
              <label
                class="btn btn-outline-secondary"
                for="radioSigned"
                autocomplete="off"
                data-bs-toggle="tooltip"
                data-bs-placement="bottom"
                title="signed"
              >
                <i class="fa-solid fa-plus-minus"></i>
              </label>
            </div>
            &nbsp;
            <div class="input-group">
              <span class="input-group-text border-secondary">BITS</span>
              <input
                type="text"
                class="form-control border-secondary"
                id="numberConverterBits"
                placeholder=""
                value="4"
                style="max-width: 40px"
              />
              &nbsp;
              <span class="input-group-text border-secondary">HEX</span>
              <input
                type="text"
                class="form-control border-secondary"
                id="numberConverterHex"
                placeholder=""
                value="0"
              />
              &nbsp;
              <span class="input-group-text border-secondary">DEC</span>
              <input
                type="text"
                class="form-control border-secondary"
                id="numberConverterDec"
                placeholder=""
                value="0"
              />
              &nbsp;
              <span class="input-group-text border-secondary">BIN</span>
              <input
                type="text"
                class="form-control border-secondary"
                id="numberConverterBin"
                placeholder=""
                value="0000"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="container-fluid" style="height: 100%">
      <div class="row" style="height: 100%">
        <div
          class="col m-0 bg-white shadow"
          style="
            max-width: 512px;
            height: 100%;
            overflow-y: scroll;
            overflow-x: hidden;
          "
        >
          <div class="row">
            <div class="col">
              <h4 class="mt-3">SELECTED STATE</h4>
              <table class="table table-bordered border-dark shadow">
                <thead>
                  <tr class="m-0 p-0">
                    <th class="bg-light text-dark my-1 py-1" scope="col">ID</th>
                    <th class="bg-light text-dark my-1 py-1" scope="col">
                      #y1
                    </th>
                    <th class="bg-light text-dark my-1 py-1" scope="col">
                      #y2
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row" class="m-0 p-0">
                      <input
                        type="text"
                        class="form-control border-white"
                        value="start"
                      />
                    </th>
                    <td class="m-0 p-0">
                      <input
                        type="text"
                        class="form-control border-white"
                        value="1100"
                      />
                    </td>
                    <td class="m-0 p-0">
                      <input
                        type="text"
                        class="form-control border-white"
                        value="1100"
                      />
                    </td>
                  </tr>
                  <tr>
                    <td colspan="3" class="m-0 p-0">
                      <input
                        type="text"
                        class="form-control border-white"
                        value="Start state"
                      />
                    </td>
                  </tr>
                </tbody>
              </table>

              <div class="my-4"></div>

              <h4 class="mt-3">
                <i class="fa-solid fa-square-minus"></i> &nbsp; SIGNALS
              </h4>

              <table class="table table-bordered border-dark shadow">
                <thead>
                  <tr>
                    <th class="bg-light text-dark my-1 py-1" scope="col">ID</th>
                    <th class="bg-light text-dark my-1 py-1" scope="col">
                      TYPE
                    </th>
                    <th class="bg-light text-dark my-1 py-1" scope="col">
                      BITS
                    </th>
                    <th class="bg-light text-dark my-1 py-1" scope="col">
                      I/O
                    </th>
                    <th class="bg-light text-dark my-1 py-1" scope="col"></th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <th scope="row" class="m-0 p-0">
                      <input
                        type="text"
                        class="form-control border-white"
                        style="max-width: 75px"
                        value="x"
                      />
                    </th>
                    <td class="m-0 p-0">
                      <div class="dropdown">
                        <button
                          class="btn btn-outline-secondary text-dark dropdown-toggle border-white"
                          type="button"
                          data-bs-toggle="dropdown"
                          aria-expanded="false"
                        >
                          BIT_N
                        </button>
                        <ul
                          class="dropdown-menu"
                          aria-labelledby="dropdownMenuButton1"
                        >
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >BIT</a
                            >
                          </li>
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >BIT_N</a
                            >
                          </li>
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >SIGNED</a
                            >
                          </li>
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >UNSIGNED</a
                            >
                          </li>
                        </ul>
                      </div>
                    </td>
                    <td class="m-0 p-0">
                      <input
                        type="text"
                        class="form-control border-white"
                        style="max-width: 55px"
                        value="8"
                      />
                    </td>
                    <td class="m-0 p-0">
                      <div class="dropdown">
                        <button
                          class="btn btn-outline-secondary text-dark dropdown-toggle border-white"
                          type="button"
                          data-bs-toggle="dropdown"
                          aria-expanded="false"
                        >
                          IN
                        </button>
                        <ul
                          class="dropdown-menu"
                          aria-labelledby="dropdownMenuButton1"
                        >
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >IN</a
                            >
                          </li>
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >OUT</a
                            >
                          </li>
                          <li>
                            <a class="dropdown-item" style="cursor: pointer"
                              >INOUT</a
                            >
                          </li>
                        </ul>
                      </div>
                    </td>
                    <td class="m-0 py-1">
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-dark"
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        title="move up"
                      >
                        <i class="fa-solid fa-arrow-up"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-dark"
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        title="move down"
                      >
                        <i class="fa-solid fa-arrow-down"></i>
                      </button>
                      <button
                        type="button"
                        class="btn btn-sm btn-outline-dark"
                        data-bs-toggle="tooltip"
                        data-bs-placement="bottom"
                        title="delete"
                      >
                        <i class="fa-solid fa-trash-can"></i>
                      </button>
                    </td>
                  </tr>
                  <tr>
                    <td class="m-0 p-0" colspan="5">
                      <input
                        type="text"
                        class="form-control border-white"
                        value="This is my description text..."
                      />
                    </td>
                  </tr>
                </tbody>
              </table>

              <div class="text-center">
                <button
                  type="button"
                  class="btn btn-sm btn-outline-dark shadow"
                  data-bs-toggle="tooltip"
                  data-bs-placement="bottom"
                  title="add signal"
                >
                  <i class="fa-solid fa-plus"></i>
                </button>
              </div>

              <br />
              <h4 class="mt-3">
                <i class="fa-solid fa-square-minus"></i> &nbsp; VARIABLES
              </h4>

              <br /><br />
              <h4 class="mt-3">
                <i class="fa-solid fa-square-plus"></i> &nbsp; STATES
              </h4>

              <h4 class="mt-3">
                <i class="fa-solid fa-square-minus"></i> &nbsp; VHDL &nbsp
              </h4>
              <div class="row mt-2">
                <div class="col">
                  <button
                    type="button"
                    class="btn btn-outline-dark"
                    data-bs-toggle="tooltip"
                    data-bs-placement="bottom"
                    title="generate VHDL code"
                  >
                    <i class="fa-solid fa-person-running"></i>
                  </button>
                  <button
                    type="button"
                    class="btn btn-outline-dark"
                    data-bs-toggle="tooltip"
                    data-bs-placement="bottom"
                    title="copy VHDL code"
                  >
                    <i class="fa-solid fa-copy"></i>
                  </button>
                </div>
              </div>
              <div
                class="border border-dark shadow mt-2 mb-4 p-1"
                style="max-height: 200px; overflow-y: scroll"
              >
                <pre>
entity T01_HelloWorldTb is
end entity;

architecture sim of T01_HelloWorldTb is
begin
    process is
    begin
        report "Hello World!";
        wait;
    end process;
end architecture;
                </pre>
              </div>

              <h4 class="mt-3">
                <i class="fa-solid fa-square-plus"></i> &nbsp; VERILOG &nbsp
                <i class="fa-solid fa-copy"></i>
              </h4>

              <h4 class="mt-3">
                <i class="fa-solid fa-square-plus"></i> &nbsp; C &nbsp
                <i class="fa-solid fa-copy"></i>
              </h4>
            </div>
          </div>
        </div>

        <div class="col ms-1 my-0 p-0 bg-white shadow">
          <canvas
            class="w-100"
            id="canvas"
            style="height: calc(100vh - 115px)"
          ></canvas>
        </div>
      </div>

      <div class="row bg-white mt-1 px-2 text-center">
        <div class="col">webSTDE, 2022 by Andreas Schwenk, LICENSE: GPLv3</div>
      </div>
      <br />
    </div>

    <script>
      var numberConverterBits = document.getElementById("numberConverterBits");
      var numberConverterHex = document.getElementById("numberConverterHex");
      var numberConverterDec = document.getElementById("numberConverterDec");
      var numberConverterBin = document.getElementById("numberConverterBin");
      numberConverterBits.value = "4";
      numberConverterHex.value = "0";
      numberConverterDec.value = "0";
      numberConverterBin.value = "0000";
      // TODO: check, if input is valid; otherwise print warning or mark red
      numberConverterHex.addEventListener("keyup", (event) => {
        let val =
          numberConverterHex.value.length == 0
            ? 0
            : parseInt(numberConverterHex.value, 16);
        numberConverterDec.value = "" + val;
        numberConverterBin.value = "" + val.toString(2);
      });
      numberConverterDec.addEventListener("keyup", (event) => {
        let val =
          numberConverterDec.value.length == 0
            ? 0
            : parseInt(numberConverterDec.value, 10);
        numberConverterHex.value = "" + val.toString(16);
        numberConverterBin.value = "" + val.toString(2);
      });

      var c = document.getElementById("canvas");
      var ctx = c.getContext("2d");

      window.onload = (event) => {
        draw();
        activateTooltips();
      };

      onresize = (event) => {
        resize();
        draw();
      };

      function resize() {
        ctx.canvas.width = Math.floor(c.clientWidth * window.devicePixelRatio);
        ctx.canvas.height = Math.floor(
          c.clientHeight * window.devicePixelRatio
        );
      }

      function draw() {
        resize();

        ctx.font = "28px Arial";
        ctx.textAlign = "left";
        ctx.fillText("output vector = [y1, y2]", 10, 35);

        drawState(500, 250, 220, 100, "start");
        drawState(500, 450, 220, 100, "stop");
        drawState(800, 450, 220, 100, "blub");
        drawTransition(500, 250 + 100 / 2, 500, 450 - 100 / 2);
      }

      function drawState(x, y, width, height, label = "") {
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.ellipse(x, y, width / 2, height / 2, 0, 0, 2 * Math.PI);
        ctx.stroke();

        ctx.moveTo(x - width / 2, y);
        ctx.lineTo(x + width / 2, y);
        ctx.stroke();

        ctx.font = "24px Arial";
        ctx.textAlign = "center";
        ctx.fillText(label, x, y - height / 6);
      }

      function drawTransition(x1, y1, x2, y2) {
        ctx.lineWidth = 2;
        // line
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.stroke();
        // arrow
        ctx.beginPath();
        const sizeX = 7;
        const sizeY = 12;
        ctx.moveTo(x2 - sizeX, y2 - sizeY);
        ctx.lineTo(x2 + sizeX, y2 - sizeY);
        ctx.lineTo(x2, y2);
        ctx.fill();
      }

      function activateTooltips() {
        var tooltipTriggerList = [].slice.call(
          document.querySelectorAll('[data-bs-toggle="tooltip"]')
        );
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
          return new bootstrap.Tooltip(tooltipTriggerEl);
        });
      }
    </script>
  </body>
</html>
